â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                            â•‘
â•‘  SCHÃ‰MA Ã‰LECTRONIQUE COMPLET - STYLET AURICULOTHÃ‰RAPIE v8.0               â•‘
â•‘  Architecture ATmega328P-AU avec Ã‰CRAN OLED I2C                            â•‘
â•‘                                                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â­ NOUVEAUTÃ‰S v8.0 :
  âœ… Ã‰cran OLED SSD1306 128Ã—32 I2C (adresse 0x3C)
  âœ… Connecteur JST-4 pour cÃ¢ble OLED
  âœ… Bouton MENU supplÃ©mentaire (PB0/D8)
  âœ… Interface I2C partagÃ©e (PCF8574 + OLED)
  âœ… Modulation frÃ©quences Nogier rÃ©activÃ©e

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“‹ SYNOPTIQUE GÃ‰NÃ‰RAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                     BATTERIE Li-Ion 3.7V (2000mAh)
                              â”‚
                              â”œâ”€â”€â”€â”€â”€â”€â”
                              â”‚      â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”  â”‚ (diviseur R8/R9)
                   â”‚              â”‚  â”‚
                   â”‚  LDO 3.3V    â”‚  â””â”€â”€> PC0 (A0) Mesure Batterie
                   â”‚  MCP1700T    â”‚
                   â”‚              â”‚
                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ +3.3V
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                â”‚                              â”‚
         â”‚                â”‚                              â”‚
   â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚           â”‚    â”‚           â”‚              â”‚                 â”‚
   â”‚  OLED     â”‚    â”‚  PCF8574T â”‚              â”‚  ATmega328P-AU  â”‚
   â”‚  128x32   â”‚    â”‚  I2C      â”‚              â”‚                 â”‚
   â”‚  @0x3C    â”‚    â”‚  @0x20    â”‚              â”‚  8MHz, 3.3V     â”‚
   â”‚           â”‚    â”‚           â”‚              â”‚                 â”‚
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                â”‚                              â”‚
         â”‚  SDA/SCL       â”‚  SDA/SCL                     â”‚ SDA/SCL
         â”‚  (pull-ups     â”‚  (pull-ups                   â”‚ (PC4/PC5)
         â”‚   4.7kÎ©)       â”‚   4.7kÎ©)                     â”‚
         â”‚                â”‚                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            BUS I2C


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”Œ U1 : ATmega328P-AU (TQFP-32)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PIN  | NOM       | FONCTION                    | CONNEXION
â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1   | PD3/OC2B  | PWM LED principale          | LED Nichia NSPW500CS (R1)
 2   | PD4       | Bouton MODE                 | SW2 + Pull-up interne
 3   | GND       | Masse                       | GND
 4   | VCC       | Alimentation                | +3.3V (via C1 100nF)
 5   | GND       | Masse                       | GND
 6   | VCC       | Alimentation                | +3.3V
 7   | PB6       | Cristal 8MHz                | XTAL1 (via C5 22pF)
 8   | PB7       | Cristal 8MHz                | XTAL2 (via C6 22pF)
 9   | PD5       | âš ï¸ Non connectÃ©             | NC (flag NC)
 10  | PD6       | âš ï¸ Non connectÃ©             | NC (flag NC)
 11  | PD7       | âš ï¸ Non connectÃ©             | NC (flag NC)
 12  | PB0       | ğŸ†• Bouton MENU (v8.0)       | SW3 + Pull-up interne
 13  | PB1       | âš ï¸ Non connectÃ©             | NC (flag NC)
 14  | PB2       | âš ï¸ Non connectÃ©             | NC (flag NC)
 15  | PB3/MOSI  | Programmation ISP           | J1 Pin 4
 16  | PB4/MISO  | Programmation ISP           | J1 Pin 1
 17  | PB5/SCK   | Programmation ISP           | J1 Pin 3
 18  | AVCC      | Alim analogique             | +3.3V (via C4 100nF)
 19  | ADC6      | âš ï¸ Non utilisÃ©              | NC (flag NC)
 20  | AREF      | RÃ©fÃ©rence ADC               | Condensateur C3 100nF â†’ GND
 21  | GND       | Masse                       | GND
 22  | ADC7      | âš ï¸ Non utilisÃ©              | NC (flag NC)
 23  | PC0/ADC0  | Mesure tension batterie     | Diviseur R8/R9 (100kÎ©/33kÎ©)
 24  | PC1       | âš ï¸ Non connectÃ©             | NC (flag NC)
 25  | PC2       | âš ï¸ Non connectÃ©             | NC (flag NC)
 26  | PC3       | âš ï¸ Non connectÃ©             | NC (flag NC)
 27  | PC4/SDA   | I2C Data                    | SDA (PCF8574 + OLED)
 28  | PC5/SCL   | I2C Clock                   | SCL (PCF8574 + OLED)
 29  | PC6/RESET | Reset                       | J1 Pin 5 + R6 (10kÎ© pull-up)
 30  | PD0/RXD   | âš ï¸ Non connectÃ©             | NC (flag NC)
 31  | PD1/TXD   | âš ï¸ Non connectÃ©             | NC (flag NC)
 32  | PD2/INT0  | Bouton FREQ (interruption)  | SW1 + Pull-up interne

NOTES :
  - Cristal 8MHz obligatoire (PB6/PB7) avec condensateurs 22pF
  - AVCC et VCC connectÃ©s Ã  +3.3V (pas de sÃ©paration)
  - AREF : condensateur 100nF pour stabilisation
  - Tous les pins NC marquÃ©s avec flag "No Connect" dans KiCad


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”Œ U2 : PCF8574T (SOIC-16) - Expandeur I2C
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PIN | NOM   | FONCTION                  | CONNEXION
â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1  | A0    | Adresse I2C bit 0         | GND (adresse 0x20)
 2  | A1    | Adresse I2C bit 1         | GND (adresse 0x20)
 3  | A2    | Adresse I2C bit 2         | GND (adresse 0x20)
 4  | P0    | Sortie 0                  | LED Rouge (via R3 470Î©)
 5  | P1    | Sortie 1                  | LED Verte (via R4 470Î©)
 6  | P2    | Sortie 2                  | LED Bleue (via R5 470Î©)
 7  | P3    | Sortie 3                  | âš ï¸ Non connectÃ© (flag NC)
 8  | VSS   | Masse                     | GND
 9  | P4    | Sortie 4                  | âš ï¸ Non connectÃ© (flag NC)
10  | P5    | Sortie 5                  | âš ï¸ Non connectÃ© (flag NC)
11  | P6    | Sortie 6                  | âš ï¸ Non connectÃ© (flag NC)
12  | P7    | Sortie 7                  | âš ï¸ Non connectÃ© (flag NC)
13  | INT   | Interruption (active LOW) | âš ï¸ Non connectÃ© (flag NC)
14  | SCL   | I2C Clock                 | SCL (bus I2C, pull-up 4.7kÎ©)
15  | SDA   | I2C Data                  | SDA (bus I2C, pull-up 4.7kÎ©)
16  | VDD   | Alimentation              | +3.3V (via C2 100nF)

CONFIGURATION ADRESSE :
  A0=A1=A2=GND â†’ Adresse I2C = 0x20 (0100000 en binaire)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”Œ U3 : MCP1700T-3302E-TT (SOT-23-3) - RÃ©gulateur LDO 3.3V
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PIN | NOM   | FONCTION                  | CONNEXION
â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1  | GND   | Masse                     | GND
 2  | VOUT  | Sortie 3.3V               | +3.3V (via C8 1ÂµF)
 3  | VIN   | EntrÃ©e batterie           | VBAT (via C7 1ÂµF)

NOTES :
  - Tension entrÃ©e : 3.7V nominal (Li-Ion)
  - Tension sortie : 3.3V rÃ©gulÃ©e
  - Courant max    : 250mA (largement suffisant)
  - Dropout        : 178mV @ 250mA
  - C7 : condensateur entrÃ©e 1ÂµF (cÃ©ramique)
  - C8 : condensateur sortie 1ÂµF (cÃ©ramique)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ†• J3 : CONNECTEUR OLED (JST-4) - NOUVEAU v8.0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PIN | NOM   | FONCTION                  | CONNEXION
â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1  | GND   | Masse                     | GND
 2  | VCC   | Alimentation 3.3V         | +3.3V
 3  | SCL   | I2C Clock                 | SCL (bus I2C partagÃ©)
 4  | SDA   | I2C Data                  | SDA (bus I2C partagÃ©)

Ã‰CRAN CONNECTÃ‰ :
  - ModÃ¨le   : OLED SSD1306 0.91" 128Ã—32
  - Interface: I2C
  - Adresse  : 0x3C (fixe)
  - Couleur  : Blanc/Bleu (selon modÃ¨le)
  - Cable    : 4 fils, longueur 10cm

âš ï¸ IMPORTANT :
  Le cÃ¢ble OLED doit avoir le bon ordre de pins :
    CÃ´tÃ© PCB : GND-VCC-SCL-SDA
    CÃ´tÃ© OLED: vÃ©rifier datasheet (parfois inversÃ© !)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”˜ BOUTONS (SWITCHES)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SW1 - Bouton FREQ (Changement frÃ©quence)
  Pin 1 : PD2 (ATmega328P pin 32)
  Pin 2 : GND
  Type  : SPST momentanÃ© (6Ã—6mm, traversant)
  Config: Pull-up interne ATmega (INPUT_PULLUP)
  ISR   : INT0 sur FALLING edge

SW2 - Bouton MODE (Changement mode)
  Pin 1 : PD4 (ATmega328P pin 2)
  Pin 2 : GND
  Type  : SPST momentanÃ© (6Ã—6mm, traversant)
  Config: Pull-up interne ATmega (INPUT_PULLUP)

ğŸ†• SW3 - Bouton MENU (Navigation menu OLED) - NOUVEAU v8.0
  Pin 1 : PB0 (ATmega328P pin 12)
  Pin 2 : GND
  Type  : SPST momentanÃ© (6Ã—6mm, traversant)
  Config: Pull-up interne ATmega (INPUT_PULLUP)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ’¡ LED PRINCIPALE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

D1 - LED Nichia NSPW500CS
  Anode  : +3.3V
  Cathode: PD3 (via R1 100Î©)
  
  CaractÃ©ristiques :
    - CRI : >90 (rendu couleur naturel)
    - Blanc chaud : 3200K
    - Tension directe : 3.0-3.4V
    - Courant max : 30mA
    - BoÃ®tier : 5mm traversant (LED_D5.0mm)
    
  Calcul rÃ©sistance R1 :
    Vf = 3.2V (typique)
    If_max = 20mA (traitement)
    R = (Vcc - Vf) / If = (3.3 - 3.2) / 0.020 = 5Î© minimum
    
    âš ï¸ UTILISATION PWM : R1 = 100Î©
       â†’ Duty cycle ajuste le courant moyen
       â†’ DÃ©tection : 25% = 5mA
       â†’ Traitement: 92% = 20mA


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ¨ LEDS RGB (Indicateurs frÃ©quence)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

D2 - LED Rouge SMD 0805
  Anode  : PCF8574 P0 (pin 4)
  Cathode: GND (via R3 470Î©)
  Vf     : 2.0V, If = 2mA

D3 - LED Verte SMD 0805
  Anode  : PCF8574 P1 (pin 5)
  Cathode: GND (via R4 470Î©)
  Vf     : 3.2V, If = 2mA

D4 - LED Bleue SMD 0805
  Anode  : PCF8574 P2 (pin 6)
  Cathode: GND (via R5 470Î©)
  Vf     : 3.2V, If = 2mA

CALCUL RÃ‰SISTANCES (R3, R4, R5) :
  R = (Vcc - Vf) / If
  R_rouge = (3.3 - 2.0) / 0.002 = 650Î© â†’ normalisÃ© 470Î© (If â‰ˆ 2.8mA)
  R_verte = (3.3 - 3.2) / 0.002 = 50Î©  â†’ normalisÃ© 470Î© (If â‰ˆ 0.2mA)
  R_bleue = (3.3 - 3.2) / 0.002 = 50Î©  â†’ normalisÃ© 470Î© (If â‰ˆ 0.2mA)
  
  âš ï¸ Valeur unique 470Î© pour toutes (simplicitÃ© BOM)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”‹ ALIMENTATION & MESURE BATTERIE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

J2 - Connecteur Batterie (JST 2.0mm)
  Pin 1 : +VBAT (3.7V nominal)
  Pin 2 : GND

DIVISEUR RÃ‰SISTIF (Mesure tension batterie)
  VBAT â”€â”¬â”€ R8 (100kÎ©) â”€â”¬â”€ R9 (33kÎ©) â”€â”¬â”€ GND
        â”‚              â”‚              â”‚
        â”‚              â””â”€â”€> PC0 (A0)  â”‚
        â”‚                             â”‚
        â””â”€> VIN (LDO U3 pin 3)        â”‚

  Calcul tension mesurÃ©e :
    V_PC0 = VBAT Ã— R9 / (R8 + R9)
    V_PC0 = 4.2V Ã— 33kÎ© / 133kÎ© = 1.04V  (batterie pleine)
    V_PC0 = 3.0V Ã— 33kÎ© / 133kÎ© = 0.74V  (batterie vide)
    
    â†’ Plage ADC : 0.74V - 1.04V (bien en dessous 3.3V)
  
  Courant diviseur :
    I = VBAT / (R8 + R9) = 4.2V / 133kÎ© = 31.6ÂµA (nÃ©gligeable)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”— BUS I2C & PULL-UPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

RÃ‰SISTANCES PULL-UP (montage parallÃ¨le pour flexibilitÃ©) :

R2a - Pull-up SDA (4.7kÎ©)
  Pin 1 : SDA (net SDA)
  Pin 2 : +3.3V

R2b - Pull-up SCL (4.7kÎ©)
  Pin 1 : SCL (net SCL)
  Pin 2 : +3.3V

âš ï¸ ALTERNATIVE : Une seule rÃ©sistance 2.2kÎ© sur chaque ligne (Ã©quivalent parallÃ¨le)

CALCUL RÃ‰SISTANCE PULL-UP :
  R_pullup = (Vcc - Vol) / (Isink_total)
  
  Avec :
    - Vcc = 3.3V
    - Vol = 0.4V (tension LOW I2C standard)
    - Isink = 3mA par pÃ©riphÃ©rique Ã— 2 = 6mA
    
  R_pullup_min = (3.3 - 0.4) / 0.006 = 483Î©  â†’ SÃ©curitÃ© : 2.2kÎ© OK
  R_pullup_max = 1000 / (400pF Ã— 100kHz) = 25kÎ©  â†’ 4.7kÎ© OK
  
  Valeur choisie : 4.7kÎ© (standard I2C, frÃ©quence 100kHz)

PÃ‰RIPHÃ‰RIQUES I2C :
  1. PCF8574T  @ 0x20 (U2)
  2. ğŸ†• OLED SSD1306 @ 0x3C (J3) - NOUVEAU v8.0


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”Œ J1 : CONNECTEUR ISP (Programmation ATmega328P)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Connecteur : 2Ã—3 pins (PinHeader_2x03_P2.54mm)

PIN | NOM   | FONCTION                  | CONNEXION
â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 1  | MISO  | Master In Slave Out       | PB4 (ATmega pin 16)
 2  | VCC   | Alimentation prog         | +3.3V
 3  | SCK   | Serial Clock              | PB5 (ATmega pin 17)
 4  | MOSI  | Master Out Slave In       | PB3 (ATmega pin 15)
 5  | RESET | Reset microcontrÃ´leur     | PC6 (ATmega pin 29)
 6  | GND   | Masse                     | GND

âš ï¸ PROGRAMMATION :
  - Programmateur : USBasp ou Arduino as ISP
  - Tension : 3.3V obligatoire (pas 5V !)
  - Fuses : 
      Low  : 0xFF (8MHz cristal, slow rising power)
      High : 0xDA (SPI enabled, boot 2048 words)
      Ext  : 0xFD (BOD 2.7V)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ› ï¸ CONDENSATEURS DE DÃ‰COUPLAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

C1 - 100nF (ATmega328P VCC pin 4)
  Pin 1 : VCC
  Pin 2 : GND
  BoÃ®tier : 0805

C2 - 100nF (PCF8574 VDD pin 16)
  Pin 1 : VDD (+3.3V)
  Pin 2 : VSS (GND)
  BoÃ®tier : 0805

C3 - 100nF (ATmega328P AREF pin 20)
  Pin 1 : AREF
  Pin 2 : GND
  BoÃ®tier : 0805

C4 - 100nF (ATmega328P AVCC pin 18)
  Pin 1 : AVCC
  Pin 2 : GND
  BoÃ®tier : 0805

C5 - 22pF (Cristal XTAL1)
  Pin 1 : PB6 (ATmega pin 7)
  Pin 2 : GND
  BoÃ®tier : 0805

C6 - 22pF (Cristal XTAL2)
  Pin 1 : PB7 (ATmega pin 8)
  Pin 2 : GND
  BoÃ®tier : 0805

C7 - 1ÂµF (LDO MCP1700 entrÃ©e)
  Pin 1 : VBAT (U3 pin 3)
  Pin 2 : GND
  BoÃ®tier : 0805

C8 - 1ÂµF (LDO MCP1700 sortie)
  Pin 1 : +3.3V (U3 pin 2)
  Pin 2 : GND
  BoÃ®tier : 0805

RÃˆGLES DE PLACEMENT :
  - Condensateurs dÃ©couplage VCC/GND : au plus prÃ¨s du pin VCC (< 5mm)
  - Condensateurs cristal : au plus prÃ¨s du cristal
  - Condensateurs LDO : au plus prÃ¨s de U3


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âš¡ LISTE DES NETS (Connexions)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

+3.3V  : Alimentation rÃ©gulÃ©e (sortie LDO U3)
  ConnectÃ© Ã  :
    - U1 VCC (pins 4, 6)
    - U1 AVCC (pin 18)
    - U2 VDD (pin 16)
    - J1 VCC (pin 2)
    - ğŸ†• J3 VCC (pin 2) - OLED
    - R2a, R2b (pull-ups I2C)
    - D1 anode
    - C1, C4, C8 (dÃ©couplages)

VBAT : Tension batterie non rÃ©gulÃ©e (3.7V)
  ConnectÃ© Ã  :
    - J2 Pin 1
    - U3 VIN (pin 3)
    - R8 (diviseur batterie)

GND : Masse commune
  ConnectÃ© Ã  :
    - Tous les pins GND des composants
    - J1 GND (pin 6)
    - J2 GND (pin 2)
    - ğŸ†• J3 GND (pin 1) - OLED
    - Plan de masse (zones cuivre F.Cu + B.Cu)

SDA : I2C Data
  ConnectÃ© Ã  :
    - U1 PC4 (pin 27)
    - U2 SDA (pin 15)
    - ğŸ†• J3 SDA (pin 4) - OLED
    - R2a (pull-up 4.7kÎ©)

SCL : I2C Clock
  ConnectÃ© Ã  :
    - U1 PC5 (pin 28)
    - U2 SCL (pin 14)
    - ğŸ†• J3 SCL (pin 3) - OLED
    - R2b (pull-up 4.7kÎ©)

LED_MAIN : Commande LED principale (PWM)
  ConnectÃ© Ã  :
    - U1 PD3 (pin 1)
    - D1 cathode (via R1)

BTN_FREQ : Bouton frÃ©quence
  ConnectÃ© Ã  :
    - U1 PD2 (pin 32)
    - SW1 Pin 1

BTN_MODE : Bouton mode
  ConnectÃ© Ã  :
    - U1 PD4 (pin 2)
    - SW2 Pin 1

ğŸ†• BTN_MENU : Bouton menu (v8.0)
  ConnectÃ© Ã  :
    - U1 PB0 (pin 12)
    - SW3 Pin 1

VBAT_SENSE : Mesure tension batterie
  ConnectÃ© Ã  :
    - U1 PC0 (pin 23)
    - Point milieu diviseur R8/R9


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“ CONTRAINTES PCB (16Ã—70mm)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COUCHES :
  - 2 couches (F.Cu + B.Cu)
  - Ã‰paisseur : 1.6mm standard
  - Finition : ENIG (or chimique) recommandÃ©e

ZONES CUIVRE (Plans de masse) :
  - F.Cu : Zone GND prioritÃ© 1
  - B.Cu : Zone GND prioritÃ© 1
  - Connexion : Vias thermiques

CLEARANCES :
  - Trace â†’ Trace : 0.2mm minimum
  - Trace â†’ Zone  : 0.2mm minimum
  - Via pad       : 0.8mm diamÃ¨tre, trou 0.4mm

LARGEUR PISTES :
  - Signaux       : 0.3mm
  - +3.3V        : 0.5mm
  - VBAT         : 0.5mm
  - GND (traces) : 0.5mm

PLACEMENT COMPOSANTS :
  Face avant (F.Cu) :
    - U1 (ATmega328P-AU) centrÃ©
    - U2 (PCF8574T) Ã  gauche
    - U3 (MCP1700T) en haut
    - LEDs RGB (D2, D3, D4) alignÃ©es
    - Tous les SMD 0805

  Face arriÃ¨re (B.Cu) :
    - Boutons SW1, SW2, ğŸ†• SW3 (traversants)
    - LED principale D1 (traversant)
    - Connecteurs J1, J2, ğŸ†• J3 (traversants)
    - Cristal Y1


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”§ MODIFICATIONS KiCad POUR v8.0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

AJOUTS SCHÃ‰MATIQUE :
  1. Ajouter SW3 (bouton MENU) :
     - Symbole : SW_PUSH
     - Footprint : SW_SPST_6x6mm_TH
     - Pin 1 â†’ PB0 (U1 pin 12)
     - Pin 2 â†’ GND
  
  2. Ajouter J3 (connecteur OLED) :
     - Symbole : Conn_01x04
     - Footprint : PinHeader_1x04_P2.54mm_Vertical ou JST_XH_B4B
     - Pin 1 (GND) â†’ GND
     - Pin 2 (VCC) â†’ +3.3V
     - Pin 3 (SCL) â†’ SCL (net existant)
     - Pin 4 (SDA) â†’ SDA (net existant)
  
  3. Modifier flag "NC" sur PB0 :
     - U1 pin 12 : SUPPRIMER le flag "No Connect"
     - Connecter Ã  SW3

VÃ‰RIFICATIONS ERC :
  âœ… Pas de nouveau "Pin not connected" (PB0 maintenant utilisÃ©)
  âœ… SDA/SCL bien partagÃ©s entre 3 composants (U1, U2, J3)
  âœ… Pull-ups toujours prÃ©sents (R2a, R2b)

AJOUTS PCB :
  1. Placer SW3 :
     - Position : entre SW1 et SW2 (alignement)
     - Face : B.Cu (arriÃ¨re)
  
  2. Placer J3 :
     - Position : bord supÃ©rieur PCB (cÃ´tÃ© LED principale)
     - Orientation : pins vers extÃ©rieur
     - Face : F.Cu (avant) ou B.Cu (selon prÃ©fÃ©rence)
  
  3. Router nouvelles pistes :
     - PB0 â†’ SW3
     - J3 pins â†’ nets existants (GND, +3.3V, SDA, SCL)

VÃ‰RIFICATIONS DRC :
  âœ… Clearances respectÃ©es
  âœ… Pas de pistes non connectÃ©es
  âœ… Zones GND mises Ã  jour (vias ajoutÃ©s si besoin)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“Š BILAN CONSOMMATION v8.0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DÃ‰TECTION (Mode 1) avec OLED actif :
  - ATmega328P @ 8MHz    : 4mA
  - PCF8574              : 0.5mA
  - LED principale (25%) : 5mA
  - LEDs RGB (1 active)  : 2mA
  - ğŸ†• OLED SSD1306      : 15mA (actif)
  - LDO quiescent        : 1.6ÂµA (nÃ©gligeable)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  TOTAL DÃ‰TECTION        : 26.5mA  â†’ Autonomie = 2000mAh / 26.5mA â‰ˆ 75h

DÃ‰TECTION avec OLED Ã©teint (aprÃ¨s 10s) :
  - Total sans OLED      : 11.5mA â†’ Autonomie = 2000mAh / 11.5mA â‰ˆ 174h
  
  ğŸ“Š AUTONOMIE MIXTE (70% Ã©teint, 30% allumÃ©) :
     I_moyen = 0.7 Ã— 11.5 + 0.3 Ã— 26.5 = 16mA
     Autonomie â‰ˆ 125h (5.2 jours)

TRAITEMENT (Mode 2) avec OLED actif :
  - ATmega328P          : 4mA
  - PCF8574             : 0.5mA
  - LED principale (92%): 20mA
  - LEDs RGB            : 2mA
  - ğŸ†• OLED actif       : 15mA
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  TOTAL TRAITEMENT      : 41.5mA  â†’ Autonomie = 2000mAh / 41.5mA â‰ˆ 48h

MODE BLANC avec OLED :
  - Total               : 31.5mA  â†’ Autonomie = 2000mAh / 31.5mA â‰ˆ 63h


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CHECKLIST VALIDATION SCHÃ‰MA v8.0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ALIMENTATION :
  âœ… LDO 3.3V avec condensateurs entrÃ©e/sortie
  âœ… Diviseur batterie (PC0) pour mesure
  âœ… DÃ©couplages VCC sur tous les ICs (100nF)
  âœ… AVCC dÃ©couplÃ© sÃ©parÃ©ment

MICROCONTRÃ”LEUR :
  âœ… Cristal 8MHz avec condensateurs 22pF
  âœ… RESET avec pull-up 10kÎ©
  âœ… Tous pins NC marquÃ©s avec flag
  âœ… ğŸ†• PB0 connectÃ© Ã  SW3 (MENU)
  âœ… ISP connecteur complet

I2C :
  âœ… Pull-ups 4.7kÎ© sur SDA/SCL
  âœ… Bus partagÃ© entre U1, U2, ğŸ†• J3
  âœ… Adresses diffÃ©rentes (0x20 vs 0x3C)

INTERFACES :
  âœ… 3 boutons (FREQ, MODE, ğŸ†• MENU)
  âœ… LED principale PWM (Timer2)
  âœ… LEDs RGB via PCF8574
  âœ… ğŸ†• Connecteur OLED J3 (JST-4)

SÃ‰CURITÃ‰ :
  âœ… Pas de conflit adresse I2C
  âœ… Courants LED limitÃ©s (rÃ©sistances)
  âœ… Protection LDO (condensateurs)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ“ NOTES FINALES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ MIGRATION v7.0 â†’ v8.0 :
   - Ajouter 1 bouton (SW3)
   - Ajouter 1 connecteur (J3 JST-4)
   - Modifier code firmware (bibliothÃ¨que Adafruit_SSD1306)
   - Routage facilitÃ© (I2C dÃ©jÃ  disponible)

âš ï¸ ATTENTION :
   - CÃ¢ble OLED : vÃ©rifier ordre pins (GND/VCC/SCL/SDA)
   - Modulation rÃ©activÃ©e : consommation CPU lÃ©gÃ¨rement augmentÃ©e
   - Timer augmente lÃ©gÃ¨rement la complexitÃ© code

ğŸš€ AVANTAGES v8.0 :
   - Interface utilisateur professionnelle
   - Feedback visuel complet (batterie, mode, frÃ©quence)
   - Timer de soin intÃ©grÃ©
   - Configuration sauvegardÃ©e (EEPROM)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  FIN DU SCHÃ‰MA v8.0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
